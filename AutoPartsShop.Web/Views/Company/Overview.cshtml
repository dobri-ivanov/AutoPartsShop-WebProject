@using AutoPartsShop.Data.Models;
@using AutoPartsShop.Services.Data.Interfaces;
@using Microsoft.AspNetCore.Identity;

@inject UserManager<ApplicationUser> UserManager
@inject ISellerService SellerService

@model CompanyOverviewViewModel

@{
    ViewBag.Title = "Your Company";
}
<style>
    th, td {
        color: black;
    }

    body {
        background-image: url("https://static.vecteezy.com/system/resources/previews/007/100/608/non_2x/abstract-geometric-white-and-gray-on-light-silver-gradient-background-modern-banner-design-illustration-free-vector.jpg");
    }

    .btn-group {
        margin-bottom: 3%;
        margin-top: 6%;
    }

    .rounded-btn {
        margin-right: 5px;
        display: inline-block;
        border-radius: 20px;
        padding: 10px 20px;
        text-decoration: none;
    }
</style>

<div class="container">
    <div class="title">
        <h1 class="text-center">@Model.Name</h1>
        <h3 class="text-center">@Model.Address</h3>
    </div>
    <div class="btn-group">
        @{
            <a href="/Company/Create" class="btn  rounded-btn btn-primary">Add Vehicle</a>
            <a href="/Company/Edit" class="btn rounded-btn btn-primary">Add Part</a>


            var user = await UserManager.GetUserAsync(User);
            var userId = user.Id;
            if (await SellerService.IsOwner(userId, Model.Id))
            {
                <a href="/Seller/Add/@Model.Id" class="btn rounded-btn btn-secondary mr-2">Add Employee</a>
                <a href="/Company/Edit/@Model.Id" class="btn rounded-btn btn-secondary">Edit Company</a>
                <a href="/Company/Delete/@Model.Id" class="btn rounded-btn btn-danger ">Delete Company</a>
            }
        }
    </div>
    <h2>Employees</h2>
    <table class="table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Phone Number</th>
                <th>Position</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.Sellers)
            {
                <tr>
                    <td>@item.UserName</td>
                    <td>@item.PhoneNumber</td>
                    <td>@item.Position</td>
                    <td>
                        @if (await SellerService.IsOwner(userId, Model.Id))
                        {
                            if (item.Position != "Owner")
                            {
                                <a href="/Seller/Edit/@item.Id" class="btn rounded-btn btn-primary">Edit</a>
                                <a href="/Seller/Fire/@item.Id" class="btn rounded-btn btn-danger">Fire</a>

                            }
                            else
                            {
                                <a href="/Seller/Edit/@item.Id" class="btn rounded-btn btn-primary">Edit</a>
                                @*<a href="/Company/Edit/@Model.Id" class="btn rounded-btn btn-info">Manage</a>*@
                            }
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
</div>

